ii<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Poker Ranges MTT Pro</title>

<!-- iOS PWA -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Poker Ranges">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
:root{
  --bg:#0b0d10;
  --panel:#141820;
  --border:#1f2633;
  --open:#2ecc71;
  --call:#1e88e5;
  --bet3:#ff9800;
  --allin:#e53935;
  --fold:#2a2f3a;
  --text:#fff;
  --muted:#8a93a3;
}

body{
  margin:0;
  background:radial-gradient(circle at top,#121621,#07090c);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,Arial;
}

header{
  padding:14px;
  text-align:center;
  font-weight:800;
  letter-spacing:1px;
  background:linear-gradient(180deg,#111520,#0a0c11);
  border-bottom:1px solid var(--border);
}

.container{padding:12px}

select,button{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  font-size:15px;
  font-weight:600;
  letter-spacing:.4px;
}

select option{font-weight:600}

button{
  background:linear-gradient(135deg,#1f2937,#111827);
}
button:active{transform:scale(.98)}

.grid{
  display:grid;
  grid-template-columns:repeat(13,1fr);
  gap:2px;
  width:100%;
}

.cell{
  aspect-ratio:1/1;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:clamp(13px,3.4vw,24px);
  border-radius:8px;
  font-weight:700;
  letter-spacing:.4px;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.06);
}

.open{background:linear-gradient(135deg,#1e824c,var(--open))}
.call{background:linear-gradient(135deg,#1565c0,var(--call))}
.bet3{background:linear-gradient(135deg,#ff6f00,var(--bet3));color:#000}
.allin{background:linear-gradient(135deg,#b71c1c,var(--allin))}
.fold{background:var(--fold);color:var(--muted)}

.legend{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  margin:8px 0;
  color:var(--muted);
}
.legend div{display:flex;align-items:center;gap:4px}
.box{width:12px;height:12px;border-radius:3px}

#percent{
  text-align:center;
  font-weight:800;
  margin:8px 0;
}

/* Tooltip */
.info{
  font-size:13px;
  color:var(--muted);
  margin:-4px 0 10px;
  position:relative;
}
.tooltip{
  display:none;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:8px;
  padding:10px;
  margin-top:6px;
  font-size:12px;
}
</style>
</head>

<body>
<header>‚ô†Ô∏è POKER RANGES ‚Äî MTT PRO</header>

<div class="container">

<select id="spot">
  <option>UTG</option><option>HJ</option><option>CO</option>
  <option>BTN</option><option>SB</option><option>BB</option>
</select>

<select id="action">
  <option value="open">Open</option>
  <option value="call">Call</option>
  <option value="bet3">3bet</option>
  <option value="allin">All-in</option>
  <option value="fold">Fold</option>
</select>

<div class="info-row">

  <div id="openInfo" class="info">
    ‚ÑπÔ∏è Open size
    <div class="tooltip">
      <strong>Open size</strong><br>
      x2 = standard<br>
      x2.5 = pression<br>
      x3 = iso / punition
    </div>
  </div>

  <div id="sbInfo" class="info">
    ‚ÑπÔ∏è SB vs BB
    <div class="tooltip">
      <strong>SB vs BB</strong><br>
      x3.5 = D√©but tournoi<br>
      x2.5 = Milieu tournoi<br>
      x2.1 = Fin tournoi
    </div>
  </div>

</div>
</div>

<select id="stack"></select>

<button onclick="resetRange()">üîÑ RESET RANGE</button>
<button onclick="exportImage()">üì§ EXPORT IMAGE</button>

<div id="percent">Range : 0%</div>

<div class="legend">
  <div><div class="box open"></div>Open</div>
  <div><div class="box call"></div>Call</div>
  <div><div class="box bet3"></div>3bet</div>
  <div><div class="box allin"></div>All-in</div>
  <div><div class="box fold"></div>Fold</div>
</div>

<div id="grid" class="grid"></div>
</div>

<script>
const ranks=["A","K","Q","J","T","9","8","7","6","5","4","3","2"];
const grid=document.getElementById("grid");
const percent=document.getElementById("percent");
const openInfo=document.getElementById("openInfo");

const stackOptionsByPosition = {
  UTG:{
    open:[
      {label:"20bb",mult:"x2"},
      {label:"30bb",mult:"x2.5"},
      {label:"45bb",mult:"x3"}
    ],
    call:[{label:"Standard"}],
    bet3:[{label:"12‚Äì30bb",mult:"Value"}],
    allin:[{label:"‚â§8bb"}],
    fold:[{label:"‚Äî"}]
  },

  HJ:{
    open:[
      {label:"20bb",mult:"x2"},
      {label:"30bb",mult:"x2.5"},
      {label:"45bb",mult:"x3"}
    ],
    call:[{label:"Standard"}],
    bet3:[{label:"12‚Äì30bb",mult:"Mix"}],
    allin:[{label:"‚â§10bb"}],
    fold:[{label:"‚Äî"}]
  },

  CO:{
    open:[
      {label:"20bb",mult:"x2"},
      {label:"30bb",mult:"x2.5"},
      {label:"45bb",mult:"x3"}
    ],
    call:[{label:"Large"}],
    bet3:[
      {label:"12‚Äì30bb",mult:"Value"},
      {label:"+50bb",mult:"Light"}
    ],
    allin:[{label:"‚â§12bb"}],
    fold:[{label:"‚Äî"}]
  },

  BTN:{
    open:[
      {label:"20bb",mult:"x2"},
      {label:"30bb",mult:"x2.5"},
      {label:"45bb",mult:"x3"}
    ],
    call:[{label:"Tr√®s large"}],
    bet3:[
      {label:"15‚Äì30bb",mult:"Aggro"},
      {label:"+50bb",mult:"Light"}
    ],
    allin:[{label:"‚â§15bb"}],
    fold:[{label:"‚Äî"}]
  },

  SB:{
    open:[
      {label:"D mtt",mult:"x3.5"},
      {label:"M mtt",mult:"x2.5"},
      {label:"F mtt",mult:"x2.1"}
    ],
    call:[{label:"Rare"}],
    bet3:[{label:"12‚Äì25bb",mult:"Polaris√©"}],
    allin:[{label:"‚â§12bb"}],
    fold:[{label:"‚Äî"}]
  },

  BB:{
    open:[
      {label:"D mtt",mult:"x3.5"},
      {label:"M mtt",mult:"x2.5"},
      {label:"F mtt",mult:"x2.1"}
    ],
    call:[{label:"Tr√®s large"}],
    bet3:[
      {label:"15‚Äì30bb",mult:"Value"},
      {label:"+40bb",mult:"Light"}
    ],
    allin:[{label:"‚â§15bb"}],
    fold:[{label:"‚Äî"}]
  }
};

/* ---------- IndexedDB ---------- */
let db;
const DB_NAME="PokerRangesDB";
const STORE="ranges";

const req=indexedDB.open(DB_NAME,1);
req.onupgradeneeded=e=>{
  db=e.target.result;
  db.createObjectStore(STORE);
};
req.onsuccess=e=>{
  db=e.target.result;
  updateStackOptions();
  build();
};

function key(){
  return `${spot.value}_${action.value}_${stack.value}`;
}

function save(data){
  const tx=db.transaction(STORE,"readwrite");
  tx.objectStore(STORE).put(data,key());
}

function load(cb){
  const tx=db.transaction(STORE,"readonly");
  const r=tx.objectStore(STORE).get(key());
  r.onsuccess=()=>cb(r.result||{});
}

function updateStackOptions(){
  stack.innerHTML="";

  const pos = spot.value;
  const act = action.value;

  const options = stackOptionsByPosition[pos][act] || [];

  options.forEach(o=>{
    const opt=document.createElement("option");
    opt.value=o.label;
    opt.innerHTML=o.mult
      ? `${o.label} <span style="opacity:.6">(${o.mult})</span>`
      : o.label;
    stack.appendChild(opt);
  });
}

function key(){
  return `range_${spot.value}_${stack.value}`;
}

function build(){
  if(!db) return;
  grid.innerHTML="";
  load(saved=>{
    ranks.forEach((r,i)=>{
      ranks.forEach((c,j)=>{
        const h=i==j?r+r:i<j?r+c+"s":c+r+"o";
        const d=document.createElement("div");
        d.className="cell "+(saved[h]||"fold");
        d.textContent=h;
        d.onclick=()=>{
          d.className="cell "+action.value;
          saved[h]=action.value;
          save(saved);
          updatePercent();
        };
        grid.appendChild(d);
      });
    });
    updatePercent();
  });
}

function updatePercent(){
  const a=[...document.querySelectorAll(".cell")].filter(c=>!c.classList.contains("fold")).length;
  percent.textContent=`${spot.value} ¬∑ ${action.value} ¬∑ ${stack.value} : ${(a/169*100).toFixed(1)}%`;
}

function resetRange(){
  if(confirm("Effacer cette range ?")){
    const tx=db.transaction(STORE,"readwrite");
    tx.objectStore(STORE).delete(key());
    build();
  }
}

function exportImage(){
  html2canvas(grid).then(c=>{
    const a=document.createElement("a");
    a.download=`${spot.value}_${action.value}_${stack.value}.png`;
    a.href=c.toDataURL();
    a.click();
  });
}

/* UI */
openInfo.onclick=()=>{
  const t=openInfo.querySelector(".tooltip");
  t.style.display=t.style.display==="block"?"none":"block";
};

action.onchange=()=>{
  updateStackOptions();
  openInfo.style.display=action.value==="open"?"block":"none";
  build();
};

spot.onchange = ()=>{
  updateStackOptions();
  build();
};

action.onchange = ()=>{
  updateStackOptions();
  openInfo.style.display = action.value==="open" ? "block" : "none";
  build();
};
</script>
</body>
</html>