<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Poker Ranges MTT Pro</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
:root{
  --panel:#141820;
  --border:#1f2633;
  --text:#fff;
  --muted:#8a93a3;

  /* Positions colors */
  --utg:#d32f2f;
  --hj:#f57c00;
  --co:#fbc02d;
  --btn:#7cb342;
  --sb:#43a047;
  --bb:#1b5e20;

  --fold:#2a2f3a;
}

body{
  margin:0;
  background:radial-gradient(circle at top,#121621,#07090c);
  color:var(--text);
  font-family:-apple-system,BlinkMacSystemFont,Arial;
}

header{
  padding:14px;
  text-align:center;
  font-weight:800;
  background:#0a0c11;
  border-bottom:1px solid var(--border);
}

.container{padding:12px}

select,button{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
  font-size:15px;
  font-weight:600;
}

.buttons{display:flex;gap:8px}

.grid{
  display:grid;
  grid-template-columns:repeat(13,1fr);
  gap:2px;
}

.cell{
  aspect-ratio:1/1;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:8px;
  font-weight:700;
  user-select:none;
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.06);
}

.fold{background:var(--fold);color:var(--muted)}
.utg{background:var(--utg)}
.hj{background:var(--hj)}
.co{background:var(--co);color:#000}
.btn{background:var(--btn)}
.sb{background:var(--sb)}
.bb{background:var(--bb)}

.legend{
  display:flex;
  justify-content:space-between;
  font-size:12px;
  margin:8px 0;
  color:var(--muted);
}
.legend div{display:flex;align-items:center;gap:4px}
.box{width:12px;height:12px;border-radius:3px}

#percent{text-align:center;font-weight:700;margin:8px 0}

.coach-on .cell{pointer-events:none;filter:brightness(.9)}
</style>
</head>

<body>

<header>‚ô†Ô∏è POKER RANGES ‚Äî MTT PRO</header>

<div class="container">

<!-- ACTIONS -->
<select id="action">
  <option value="open">Open</option>
  <option value="open3bet">Open 3bet</option>
  <option value="call">Call</option>
  <option value="raise">Raise</option>
  <option value="allin">All-in</option>
</select>

<!-- OPTIONS -->
<select id="stack"></select>

<div class="buttons">
  <button id="coachToggle">üß† Coach : OFF</button>
  <button onclick="exportImage()">üì§ Image</button>
</div>

<div class="buttons">
  <button onclick="exportJSON()">üíæ Export JSON</button>
  <button onclick="importJSON()">üìÇ Import JSON</button>
</div>

<div id="percent">Range : 0%</div>

<!-- LEGEND POSITIONS -->
<div class="legend">
  <div><div class="box utg"></div>UTG</div>
  <div><div class="box hj"></div>HJ</div>
  <div><div class="box co"></div>CO</div>
  <div><div class="box btn"></div>BTN</div>
  <div><div class="box sb"></div>SB</div>
  <div><div class="box bb"></div>BB</div>
</div>

<div id="grid" class="grid"></div>
</div>

<script>
const ranks=["A","K","Q","J","T","9","8","7","6","5","4","3","2"];
const grid=document.getElementById("grid");
const stack=document.getElementById("stack");
const percent=document.getElementById("percent");
let coachMode=false;

/* ACTION CONFIG */
const ACTIONS={
  open:["2bb","2.2bb","2.5bb"],
  open3bet:["6bb","7.5bb","9bb"],
  call:["Tight","Standard","Loose"],
  raise:["Small","Medium","Big"],
  allin:["‚â§10bb","‚â§15bb","‚â§20bb"]
};

/* ROTATING POSITION COLORS */
const POSITIONS=["utg","hj","co","btn","sb","bb"];

function updateStack(){
  stack.innerHTML="";
  ACTIONS[action.value].forEach(v=>{
    const o=document.createElement("option");
    o.textContent=v;
    stack.appendChild(o);
  });
}

function key(){
  return `range_${action.value}_${stack.value}`;
}

function build(){
  grid.innerHTML="";
  const saved=JSON.parse(localStorage.getItem(key())||"{}");
  let posIndex=0;

  ranks.forEach((r,i)=>ranks.forEach((c,j)=>{
    const h=i===j?r+r:i<j?r+c+"s":c+r+"o";
    const d=document.createElement("div");
    const pos=POSITIONS[posIndex%6];

    d.className="cell "+(saved[h]||"fold");
    d.dataset.pos=pos;
    d.textContent=h;

    d.onclick=()=>{
      if(coachMode) return;
      if(saved[h]){
        delete saved[h];
        d.className="cell fold";
      }else{
        saved[h]=pos;
        d.className="cell "+pos;
      }
      localStorage.setItem(key(),JSON.stringify(saved));
      updatePercent();
    };

    grid.appendChild(d);
    posIndex++;
  }));
  updatePercent();
}

function updatePercent(){
  const a=[...document.querySelectorAll('.cell')].filter(c=>!c.classList.contains("fold")).length;
  percent.textContent=`${action.value.toUpperCase()} ¬∑ ${stack.value} : ${(a/169*100).toFixed(1)}%`;
}

coachToggle.onclick=()=>{
  coachMode=!coachMode;
  document.body.classList.toggle("coach-on",coachMode);
  coachToggle.textContent=coachMode?"üß† Coach : ON":"üß† Coach : OFF";
};

function exportImage(){
  html2canvas(grid).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL();
    a.download=key()+".png";
    a.click();
  });
}

function exportJSON(){
  const data={};
  Object.keys(localStorage).filter(k=>k.startsWith("range_"))
    .forEach(k=>data[k]=JSON.parse(localStorage.getItem(k)));
  const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="ranges_backup.json";
  a.click();
}

function importJSON(){
  const i=document.createElement("input");
  i.type="file";
  i.accept="application/json";
  i.onchange=e=>{
    const r=new FileReader();
    r.onload=()=>{
      const d=JSON.parse(r.result);
      Object.keys(d).forEach(k=>localStorage.setItem(k,JSON.stringify(d[k])));
      build();
      alert("‚úÖ Import termin√©");
    };
    r.readAsText(e.target.files[0]);
  };
  i.click();
}

action.onchange=()=>{updateStack();build()};
stack.onchange=build;

updateStack();
build();
</script>

</body>
</html>