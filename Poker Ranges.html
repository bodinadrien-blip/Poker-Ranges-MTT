<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Poker Ranges MTT Pro+</title>

<!-- PWA iOS / Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Poker Ranges">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
body{margin:0;background:#0e0e0e;color:#fff;font-family:-apple-system,BlinkMacSystemFont,Arial}
header{padding:14px;text-align:center;background:#1c1c1c;font-weight:700}
.container{padding:12px}
select,input,button{width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:none;font-size:15px}
select,input{background:#1f1f1f;color:#fff}
button{background:#4caf50;color:#fff}
.grid{display:grid;grid-template-columns:repeat(13,1fr);gap:2px;margin-top:10px;transform:scale(0.75);transform-origin:top center}
.cell{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;font-size:30px;border-radius:10px;user-select:none;font-weight:600;letter-spacing:0.5px;box-shadow:inset 0 0 0 1px rgba(255,255,255,0.05)}
.open{background:linear-gradient(135deg,#1b5e20,#2e7d32)}
.call{background:linear-gradient(135deg,#0d47a1,#1565c0)}
.allin{background:linear-gradient(135deg,#8e0000,#c62828)}
.fold{background:#1f1f1f;color:#666}
.legend{display:flex;justify-content:space-between;font-size:12px;margin:8px 0}
.legend div{display:flex;align-items:center;gap:4px}
.box{width:12px;height:12px;border-radius:3px}
#percent{margin-top:8px;text-align:center;font-weight:600}
.bet3{background:linear-gradient(135deg,#ff8f00,#ffb300)}
</style>
</head>

<body>
<header>‚ô†Ô∏è Poker Ranges MTT Pro+</header>

<div class="container">

<select id="spot">
<option value="UTG">UTG</option>
<option value="HJ">HJ</option>
<option value="CO">CO</option>
<option value="BTN">BTN</option>
<option value="SB">SB</option>
<option value="BB">BB</option>
</select>

<select id="action">
<option value="open">Open</option>
<option value="call">Call</option>
<option value="bet3">3bet</option>
<option value="allin">All-in</option>
<option value="fold">Fold</option>
</select>

<input id="stack" type="number" min="1" max="100" step="1" value="20" placeholder="Stack en BB">

<button onclick="exportImage()">üì§ Exporter l'image</button>

<div id="percent">Range s√©lectionn√©e : 0%</div>

<div class="legend">
  <div><div class="box open"></div>Open</div>
  <div><div class="box call"></div>Call</div>
  <div><div class="box bet3"></div>3bet</div>
  <div><div class="box allin"></div>All-in</div>
  <div><div class="box fold"></div>Fold</div>
</div>

<div id="grid" class="grid"></div>

</div>

<script>
const ranks=["A","K","Q","J","T","9","8","7","6","5","4","3","2"];
const grid=document.getElementById("grid");

function key(){
return `range_${spot.value}_${stack.value}`;
}

function build(){
grid.innerHTML="";
let saved=JSON.parse(localStorage.getItem(key())||"{}");
for(let i=0;i<13;i++){
for(let j=0;j<13;j++){
let h=i==j?ranks[i]+ranks[j]:i<j?ranks[i]+ranks[j]+"s":ranks[j]+ranks[i]+"o";
let d=document.createElement("div");
d.className="cell "+(saved[h]||"fold");
d.textContent=h;
d.onclick=()=>{
d.className="cell "+action.value;
saved[h]=action.value;
localStorage.setItem(key(),JSON.stringify(saved));
updatePercent();
};
grid.appendChild(d);
}
}
updatePercent();
}

function updatePercent(){
let cells=[...document.querySelectorAll('.cell')];
let active=cells.filter(c=>!c.classList.contains('fold')).length;
let pct=((active/169)*100).toFixed(1);
document.getElementById('percent').textContent=`Range s√©lectionn√©e : ${pct}%`;
}

function exportImage(){
html2canvas(grid).then(canvas=>{
let link=document.createElement("a");
link.download=`range_${spot.value}_${stack.value}bb.png`;
link.href=canvas.toDataURL();
link.click();
});
}

spot.onchange=build;
stack.onchange=build;

build();

// PWA Service Worker
if('serviceWorker' in navigator){
window.addEventListener('load',()=>{
navigator.serviceWorker.register('sw.js');
});
}
</script>

</body>
</html>
